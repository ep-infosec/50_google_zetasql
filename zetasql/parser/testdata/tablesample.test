select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE(10)
--
QueryStatement [0-69] [select uId...REPEATABLE(10)]
  Query [0-69] [select uId...REPEATABLE(10)]
    Select [0-69] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-69] [from Users...REPEATABLE(10)]
        TablePathExpression [16-69] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-69] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-53] [100 ROWS]
              IntLiteral(100) [45-48] [100]
            SampleSuffix [55-69] [REPEATABLE(10)]
              RepeatableClause [55-69] [REPEATABLE(10)]
                IntLiteral(10) [66-68] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(100 ROWS) REPEATABLE (10)
==

select uId from Users TABLESAMPLE RESERVOIR (cast(100 as int32) ROWS)
                                            REPEATABLE(cast(10 as int32))
--
QueryStatement [0-143] [select uId...as int32))]
  Query [0-143] [select uId...as int32))]
    Select [0-143] [select uId...as int32))]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-143] [from Users...as int32))]
        TablePathExpression [16-143] [Users TABLESAMPLE...as int32))]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-143] [TABLESAMPLE...as int32))]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-68] [cast(100 as int32) ROWS]
              CastExpression [45-63] [cast(100 as int32)]
                IntLiteral(100) [50-53] [100]
                SimpleType [57-62] [int32]
                  PathExpression [57-62] [int32]
                    Identifier(int32) [57-62] [int32]
            SampleSuffix [114-143] [REPEATABLE(cast(10 as int32))]
              RepeatableClause [114-143] [REPEATABLE(cast(10 as int32))]
                CastExpression [125-142] [cast(10 as int32)]
                  IntLiteral(10) [130-132] [10]
                  SimpleType [136-141] [int32]
                    PathExpression [136-141] [int32]
                      Identifier(int32) [136-141] [int32]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(CAST(100 AS int32) ROWS) REPEATABLE (CAST(10 AS int32))
==

select uId from Users TABLESAMPLE RESERVOIR (@param1 ROWS) REPEATABLE(@param2)
--
QueryStatement [0-78] [select uId...PEATABLE(@param2)]
  Query [0-78] [select uId...PEATABLE(@param2)]
    Select [0-78] [select uId...PEATABLE(@param2)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-78] [from Users...PEATABLE(@param2)]
        TablePathExpression [16-78] [Users TABLESAMPLE...E(@param2)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-78] [TABLESAMPLE...EATABLE(@param2)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-57] [@param1 ROWS]
              ParameterExpr [45-52] [@param1]
                Identifier(param1) [46-52] [param1]
            SampleSuffix [59-78] [REPEATABLE(@param2)]
              RepeatableClause [59-78] [REPEATABLE(@param2)]
                ParameterExpr [70-77] [@param2]
                  Identifier(param2) [71-77] [param2]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(@param1 ROWS) REPEATABLE (@param2)
==

select uId from Users TABLESAMPLE RESERVOIR (cast(@param1 as int32) ROWS)
                                            REPEATABLE(cast(@param2 as string))
--
QueryStatement [0-153] [select uId...as string))]
  Query [0-153] [select uId...as string))]
    Select [0-153] [select uId...as string))]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-153] [from Users...as string))]
        TablePathExpression [16-153] [Users TABLESAMPLE...s string))]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-153] [TABLESAMPLE...as string))]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-72] [cast(@param1 as int32) ROWS]
              CastExpression [45-67] [cast(@param1 as int32)]
                ParameterExpr [50-57] [@param1]
                  Identifier(param1) [51-57] [param1]
                SimpleType [61-66] [int32]
                  PathExpression [61-66] [int32]
                    Identifier(int32) [61-66] [int32]
            SampleSuffix [118-153] [REPEATABLE...as string))]
              RepeatableClause [118-153] [REPEATABLE...as string))]
                CastExpression [129-152] [cast(@param2 as string)]
                  ParameterExpr [134-141] [@param2]
                    Identifier(param2) [135-141] [param2]
                  SimpleType [145-151] [string]
                    PathExpression [145-151] [string]
                      Identifier(string) [145-151] [string]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(CAST(@param1 AS int32) ROWS) REPEATABLE (CAST(@param2 AS string))
==

select uId from Users TABLESAMPLE RESERVOIR (@@sysvar1 ROWS) REPEATABLE(@@sysvar2)
--
QueryStatement [0-82] [select uId...@@sysvar2)]
  Query [0-82] [select uId...@@sysvar2)]
    Select [0-82] [select uId...@@sysvar2)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-82] [from Users...@@sysvar2)]
        TablePathExpression [16-82] [Users TABLESAMPLE...@@sysvar2)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-82] [TABLESAMPLE...@@sysvar2)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-59] [@@sysvar1 ROWS]
              SystemVariableExpr [45-54] [@@sysvar1]
                PathExpression [47-54] [sysvar1]
                  Identifier(sysvar1) [47-54] [sysvar1]
            SampleSuffix [61-82] [REPEATABLE(@@sysvar2)]
              RepeatableClause [61-82] [REPEATABLE(@@sysvar2)]
                SystemVariableExpr [72-81] [@@sysvar2]
                  PathExpression [74-81] [sysvar2]
                    Identifier(sysvar2) [74-81] [sysvar2]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(@@sysvar1 ROWS) REPEATABLE (@@sysvar2)
==

select uId from Users TABLESAMPLE (100 ROWS) REPEATABLE(10)
--
ERROR: Syntax error: Unexpected "(" [at 1:35]
select uId from Users TABLESAMPLE (100 ROWS) REPEATABLE(10)
                                  ^
==

# As RESERVOIR is a non-reserved keyword, it is treated as an alias to the table
# Users here.
select uId from Users RESERVOIR (100 ROWS) REPEATABLE(10)
--
ERROR: Syntax error: Expected end of input but got "(" [at 1:33]
select uId from Users RESERVOIR (100 ROWS) REPEATABLE(10)
                                ^
==

select uId from Users RESERVOIR TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE(10)
--
QueryStatement [0-79] [select uId...REPEATABLE(10)]
  Query [0-79] [select uId...REPEATABLE(10)]
    Select [0-79] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-79] [from Users...REPEATABLE(10)]
        TablePathExpression [16-79] [Users RESERVOIR...PEATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          Alias [22-31] [RESERVOIR]
            Identifier(RESERVOIR) [22-31] [RESERVOIR]
          SampleClause [32-79] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(RESERVOIR) [44-53] [RESERVOIR]
            SampleSize [55-63] [100 ROWS]
              IntLiteral(100) [55-58] [100]
            SampleSuffix [65-79] [REPEATABLE(10)]
              RepeatableClause [65-79] [REPEATABLE(10)]
                IntLiteral(10) [76-78] [10]
--
SELECT
  uId
FROM
  Users AS RESERVOIR TABLESAMPLE RESERVOIR(100 ROWS) REPEATABLE (10)
==

SELECT * FROM Users TABLESAMPLE RESERVOIR (10 ROWS PARTITION BY state, zipcode)
--
QueryStatement [0-79] [SELECT * FROM..., zipcode)]
  Query [0-79] [SELECT * FROM..., zipcode)]
    Select [0-79] [SELECT * FROM..., zipcode)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-79] [FROM Users..., zipcode)]
        TablePathExpression [14-79] [Users TABLESAMPLE..., zipcode)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-79] [TABLESAMPLE..., zipcode)]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-78] [10 ROWS PARTITION...e, zipcode]
              IntLiteral(10) [43-45] [10]
              PartitionBy [51-78] [PARTITION BY state, zipcode]
                PathExpression [64-69] [state]
                  Identifier(state) [64-69] [state]
                PathExpression [71-78] [zipcode]
                  Identifier(zipcode) [71-78] [zipcode]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(10 ROWS PARTITION BY state, zipcode)
==

select uId from Users RESERVOIR TABLESAMPLE (100 ROWS) REPEATABLE(10)
--
ERROR: Syntax error: Unexpected "(" [at 1:45]
select uId from Users RESERVOIR TABLESAMPLE (100 ROWS) REPEATABLE(10)
                                            ^
==

select uId from Users TABLESAMPLE RESERVOIR ROWS(100) REPEATABLE(10)
--
ERROR: Syntax error: Expected "(" but got keyword ROWS [at 1:45]
select uId from Users TABLESAMPLE RESERVOIR ROWS(100) REPEATABLE(10)
                                            ^
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) (10 REPEATABLE)
--
ERROR: Syntax error: Expected end of input but got "(" [at 1:56]
select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) (10 REPEATABLE)
                                                       ^
==

select uId from Users TABLESAMPLE RESERVOIR REPEATABLE(10)
--
ERROR: Syntax error: Expected "(" but got keyword REPEATABLE [at 1:45]
select uId from Users TABLESAMPLE RESERVOIR REPEATABLE(10)
                                            ^
==

select uId from Users TABLESAMPLE RESERVOIR 100 ROWS REPEATABLE(10)
--
ERROR: Syntax error: Expected "(" but got integer literal "100" [at 1:45]
select uId from Users TABLESAMPLE RESERVOIR 100 ROWS REPEATABLE(10)
                                            ^
==

select uId from Users TABLESAMPLE RESERVOIR (100) REPEATABLE(10)
--
ERROR: Syntax error: Expected keyword PERCENT or keyword ROWS but got ")" [at 1:49]
select uId from Users TABLESAMPLE RESERVOIR (100) REPEATABLE(10)
                                                ^
==

select uId from Users TABLESAMPLE RESERVOIR () REPEATABLE(10)
--
ERROR: Syntax error: Unexpected ")" [at 1:46]
select uId from Users TABLESAMPLE RESERVOIR () REPEATABLE(10)
                                             ^
==

select uId from Users TABLESAMPLE RESERVOIR REPEATABLE(10)
--
ERROR: Syntax error: Expected "(" but got keyword REPEATABLE [at 1:45]
select uId from Users TABLESAMPLE RESERVOIR REPEATABLE(10)
                                            ^
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE()
--
ERROR: Syntax error: Unexpected ")" [at 1:67]
select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE()
                                                                  ^
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE
--
ERROR: Syntax error: Expected "(" but got end of statement [at 1:66]
select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE
                                                                 ^
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) (10)
--
ERROR: Syntax error: Expected end of input but got "(" [at 1:56]
select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) (10)
                                                       ^
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) 10
--
ERROR: Syntax error: Expected end of input but got integer literal "10" [at 1:56]
select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) 10
                                                       ^
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS)
--
QueryStatement [0-54] [select uId...(100 ROWS)]
  Query [0-54] [select uId...(100 ROWS)]
    Select [0-54] [select uId...(100 ROWS)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-54] [from Users...(100 ROWS)]
        TablePathExpression [16-54] [Users TABLESAMPLE...(100 ROWS)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-54] [TABLESAMPLE...(100 ROWS)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-53] [100 ROWS]
              IntLiteral(100) [45-48] [100]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(100 ROWS)
==

select uId from Users TABLESAMPLE RESERVOIR (0.1 PERCENT) REPEATABLE(10)
--
QueryStatement [0-72] [select uId...REPEATABLE(10)]
  Query [0-72] [select uId...REPEATABLE(10)]
    Select [0-72] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-72] [from Users...REPEATABLE(10)]
        TablePathExpression [16-72] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-72] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-56] [0.1 PERCENT]
              FloatLiteral(0.1) [45-48] [0.1]
            SampleSuffix [58-72] [REPEATABLE(10)]
              RepeatableClause [58-72] [REPEATABLE(10)]
                IntLiteral(10) [69-71] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(0.1 PERCENT) REPEATABLE (10)
==

select uId from Users TABLESAMPLE RESERVOIR (100 PERCENT) REPEATABLE(10)
--
QueryStatement [0-72] [select uId...REPEATABLE(10)]
  Query [0-72] [select uId...REPEATABLE(10)]
    Select [0-72] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-72] [from Users...REPEATABLE(10)]
        TablePathExpression [16-72] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-72] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-56] [100 PERCENT]
              IntLiteral(100) [45-48] [100]
            SampleSuffix [58-72] [REPEATABLE(10)]
              RepeatableClause [58-72] [REPEATABLE(10)]
                IntLiteral(10) [69-71] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(100 PERCENT) REPEATABLE (10)
==

# Query should fail while resolving, float literal on ROWS doesn't makes sense.
select uId from Users TABLESAMPLE RESERVOIR (0.1 ROWS) REPEATABLE(10)
--
QueryStatement [0-69] [select uId...REPEATABLE(10)]
  Query [0-69] [select uId...REPEATABLE(10)]
    Select [0-69] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-69] [from Users...REPEATABLE(10)]
        TablePathExpression [16-69] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-69] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(RESERVOIR) [34-43] [RESERVOIR]
            SampleSize [45-53] [0.1 ROWS]
              FloatLiteral(0.1) [45-48] [0.1]
            SampleSuffix [55-69] [REPEATABLE(10)]
              RepeatableClause [55-69] [REPEATABLE(10)]
                IntLiteral(10) [66-68] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RESERVOIR(0.1 ROWS) REPEATABLE (10)
==

select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE(1.0)
--
ERROR: Syntax error: Unexpected floating point literal "1.0" [at 1:67]
select uId from Users TABLESAMPLE RESERVOIR (100 ROWS) REPEATABLE(1.0)
                                                                  ^
==

select uId from Users TABLESAMPLE BERNOULLI (100 ROWS) REPEATABLE(10)
--
QueryStatement [0-69] [select uId...REPEATABLE(10)]
  Query [0-69] [select uId...REPEATABLE(10)]
    Select [0-69] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-69] [from Users...REPEATABLE(10)]
        TablePathExpression [16-69] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-69] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(BERNOULLI) [34-43] [BERNOULLI]
            SampleSize [45-53] [100 ROWS]
              IntLiteral(100) [45-48] [100]
            SampleSuffix [55-69] [REPEATABLE(10)]
              RepeatableClause [55-69] [REPEATABLE(10)]
                IntLiteral(10) [66-68] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE BERNOULLI(100 ROWS) REPEATABLE (10)
==

select uId from Users TABLESAMPLE SYSTEM (100 ROWS) REPEATABLE(10)
--
QueryStatement [0-66] [select uId...REPEATABLE(10)]
  Query [0-66] [select uId...REPEATABLE(10)]
    Select [0-66] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-66] [from Users...REPEATABLE(10)]
        TablePathExpression [16-66] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-66] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(SYSTEM) [34-40] [SYSTEM]
            SampleSize [42-50] [100 ROWS]
              IntLiteral(100) [42-45] [100]
            SampleSuffix [52-66] [REPEATABLE(10)]
              RepeatableClause [52-66] [REPEATABLE(10)]
                IntLiteral(10) [63-65] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE SYSTEM(100 ROWS) REPEATABLE (10)
==

select uId from Users TABLESAMPLE RANDOM (100 ROWS) REPEATABLE(10)
--
QueryStatement [0-66] [select uId...REPEATABLE(10)]
  Query [0-66] [select uId...REPEATABLE(10)]
    Select [0-66] [select uId...REPEATABLE(10)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-66] [from Users...REPEATABLE(10)]
        TablePathExpression [16-66] [Users TABLESAMPLE...ATABLE(10)]
          PathExpression [16-21] [Users]
            Identifier(Users) [16-21] [Users]
          SampleClause [22-66] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(RANDOM) [34-40] [RANDOM]
            SampleSize [42-50] [100 ROWS]
              IntLiteral(100) [42-45] [100]
            SampleSuffix [52-66] [REPEATABLE(10)]
              RepeatableClause [52-66] [REPEATABLE(10)]
                IntLiteral(10) [63-65] [10]
--
SELECT
  uId
FROM
  Users TABLESAMPLE RANDOM(100 ROWS) REPEATABLE (10)
==

select *
from (select uId from Users) TABLESAMPLE BERNOULLI (100 ROWS) REPEATABLE(10)
--
QueryStatement [0-85] [select * from...REPEATABLE(10)]
  Query [0-85] [select * from...REPEATABLE(10)]
    Select [0-85] [select * from...REPEATABLE(10)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-85] [from (select...REPEATABLE(10)]
        TableSubquery [14-85] [(select uId...REPEATABLE(10)]
          Query [15-36] [select uId from Users]
            Select [15-36] [select uId from Users]
              SelectList [22-25] [uId]
                SelectColumn [22-25] [uId]
                  PathExpression [22-25] [uId]
                    Identifier(uId) [22-25] [uId]
              FromClause [26-36] [from Users]
                TablePathExpression [31-36] [Users]
                  PathExpression [31-36] [Users]
                    Identifier(Users) [31-36] [Users]
          SampleClause [38-85] [TABLESAMPLE...REPEATABLE(10)]
            Identifier(BERNOULLI) [50-59] [BERNOULLI]
            SampleSize [61-69] [100 ROWS]
              IntLiteral(100) [61-64] [100]
            SampleSuffix [71-85] [REPEATABLE(10)]
              RepeatableClause [71-85] [REPEATABLE(10)]
                IntLiteral(10) [82-84] [10]
--
SELECT
  *
FROM
  (
    SELECT
      uId
    FROM
      Users
  ) TABLESAMPLE BERNOULLI(100 ROWS) REPEATABLE (10)
==

select * from (a JOIN (select * from Users)) TABLESAMPLE RESERVOIR (100 ROWS)
--
QueryStatement [0-77] [select * from...(100 ROWS)]
  Query [0-77] [select * from...(100 ROWS)]
    Select [0-77] [select * from...(100 ROWS)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-77] [from (a JOIN...(100 ROWS)]
        ParenthesizedJoin [14-77] [(a JOIN (select...(100 ROWS)]
          Join [15-43] [a JOIN (select * from Users)]
            TablePathExpression [15-16] [a]
              PathExpression [15-16] [a]
                Identifier(a) [15-16] [a]
            Location [17-21] [JOIN]
            TableSubquery [22-43] [(select * from Users)]
              Query [23-42] [select * from Users]
                Select [23-42] [select * from Users]
                  SelectList [30-31] [*]
                    SelectColumn [30-31] [*]
                      Star(*) [30-31] [*]
                  FromClause [32-42] [from Users]
                    TablePathExpression [37-42] [Users]
                      PathExpression [37-42] [Users]
                        Identifier(Users) [37-42] [Users]
          SampleClause [45-77] [TABLESAMPLE...(100 ROWS)]
            Identifier(RESERVOIR) [57-66] [RESERVOIR]
            SampleSize [68-76] [100 ROWS]
              IntLiteral(100) [68-71] [100]
--
SELECT
  *
FROM
  (
    a
    JOIN
    (
      SELECT
        *
      FROM
        Users
    )
  ) TABLESAMPLE RESERVOIR(100 ROWS)
==

select * from a, (select * from Users) TABLESAMPLE RESERVOIR (5 ROWS) where true
--
QueryStatement [0-80] [select * from...where true]
  Query [0-80] [select * from...where true]
    Select [0-80] [select * from...where true]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-69] [from a, (select...OIR (5 ROWS)]
        Join(COMMA) [14-69] [a, (select...ESERVOIR (5 ROWS)]
          TablePathExpression [14-15] [a]
            PathExpression [14-15] [a]
              Identifier(a) [14-15] [a]
          Location [15-16] [,]
          TableSubquery [17-69] [(select *...RESERVOIR (5 ROWS)]
            Query [18-37] [select * from Users]
              Select [18-37] [select * from Users]
                SelectList [25-26] [*]
                  SelectColumn [25-26] [*]
                    Star(*) [25-26] [*]
                FromClause [27-37] [from Users]
                  TablePathExpression [32-37] [Users]
                    PathExpression [32-37] [Users]
                      Identifier(Users) [32-37] [Users]
            SampleClause [39-69] [TABLESAMPLE RESERVOIR (5 ROWS)]
              Identifier(RESERVOIR) [51-60] [RESERVOIR]
              SampleSize [62-68] [5 ROWS]
                IntLiteral(5) [62-63] [5]
      WhereClause [70-80] [where true]
        BooleanLiteral(true) [76-80] [true]
--
SELECT
  *
FROM
  a,
  (
    SELECT
      *
    FROM
      Users
  ) TABLESAMPLE RESERVOIR(5 ROWS)
WHERE
  true
==

# PERCENT, REPEATABLE are non-reserved keywords and can be used as identifiers.
select 4 PERCENT, 5 REPEATABLE
from Users TABLESAMPLE RESERVOIR (0 PERCENT) REPEATABLE(1)
--
QueryStatement [0-89] [select 4 PERCENT...PEATABLE(1)]
  Query [0-89] [select 4 PERCENT...PEATABLE(1)]
    Select [0-89] [select 4 PERCENT...PEATABLE(1)]
      SelectList [7-30] [4 PERCENT, 5 REPEATABLE]
        SelectColumn [7-16] [4 PERCENT]
          IntLiteral(4) [7-8] [4]
          Alias [9-16] [PERCENT]
            Identifier(PERCENT) [9-16] [PERCENT]
        SelectColumn [18-30] [5 REPEATABLE]
          IntLiteral(5) [18-19] [5]
          Alias [20-30] [REPEATABLE]
            Identifier(REPEATABLE) [20-30] [REPEATABLE]
      FromClause [31-89] [from Users...REPEATABLE(1)]
        TablePathExpression [36-89] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [36-41] [Users]
            Identifier(Users) [36-41] [Users]
          SampleClause [42-89] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(RESERVOIR) [54-63] [RESERVOIR]
            SampleSize [65-74] [0 PERCENT]
              IntLiteral(0) [65-66] [0]
            SampleSuffix [76-89] [REPEATABLE(1)]
              RepeatableClause [76-89] [REPEATABLE(1)]
                IntLiteral(1) [87-88] [1]
--
SELECT
  4 AS PERCENT,
  5 AS REPEATABLE
FROM
  Users TABLESAMPLE RESERVOIR(0 PERCENT) REPEATABLE (1)
==

# TABLESAMPLE is a reserved keyword and cannot be used as an identifier.
select 1 TABLESAMPLE from Users TABLESAMPLE RESERVOIR (1 ROWS)
--
ERROR: Syntax error: Expected end of input but got keyword TABLESAMPLE [at 1:10]
select 1 TABLESAMPLE from Users TABLESAMPLE RESERVOIR (1 ROWS)
         ^
==

# ROWS is a reserved keyword and cannot be used as an identifier.
select 1 ROWS from Users from TABLESAMPLE RESERVOIR (1 ROWS)
--
ERROR: Syntax error: Expected end of input but got keyword ROWS [at 1:10]
select 1 ROWS from Users from TABLESAMPLE RESERVOIR (1 ROWS)
         ^
==

select * from Users TABLESAMPLE RESERVOIR (-1 ROWS)
--
ERROR: Syntax error: Unexpected "-" [at 1:44]
select * from Users TABLESAMPLE RESERVOIR (-1 ROWS)
                                           ^
==

select * from Users TABLESAMPLE RESERVOIR (1 ROW)
--
ERROR: Syntax error: Expected keyword PERCENT or keyword ROWS but got keyword ROW [at 1:46]
select * from Users TABLESAMPLE RESERVOIR (1 ROW)
                                             ^
==

select * from a, b TABLESAMPLE RESERVOIR (1 ROWS)
--
QueryStatement [0-49] [select * from...RVOIR (1 ROWS)]
  Query [0-49] [select * from...RVOIR (1 ROWS)]
    Select [0-49] [select * from...RVOIR (1 ROWS)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-49] [from a, b...RESERVOIR (1 ROWS)]
        Join(COMMA) [14-49] [a, b TABLESAMPLE...IR (1 ROWS)]
          TablePathExpression [14-15] [a]
            PathExpression [14-15] [a]
              Identifier(a) [14-15] [a]
          Location [15-16] [,]
          TablePathExpression [17-49] [b TABLESAMPLE...RVOIR (1 ROWS)]
            PathExpression [17-18] [b]
              Identifier(b) [17-18] [b]
            SampleClause [19-49] [TABLESAMPLE RESERVOIR (1 ROWS)]
              Identifier(RESERVOIR) [31-40] [RESERVOIR]
              SampleSize [42-48] [1 ROWS]
                IntLiteral(1) [42-43] [1]
--
SELECT
  *
FROM
  a,
  b TABLESAMPLE RESERVOIR(1 ROWS)
==

select * from (a, b) TABLESAMPLE RESERVOIR (1 ROWS)
--
ERROR: Syntax error: Expected keyword JOIN but got "," [at 1:17]
select * from (a, b) TABLESAMPLE RESERVOIR (1 ROWS)
                ^
==

select * from a JOIN b TABLESAMPLE RESERVOIR (1 ROWS)
--
QueryStatement [0-53] [select * from...RVOIR (1 ROWS)]
  Query [0-53] [select * from...RVOIR (1 ROWS)]
    Select [0-53] [select * from...RVOIR (1 ROWS)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-53] [from a JOIN...SERVOIR (1 ROWS)]
        Join [14-53] [a JOIN b TABLESAM...R (1 ROWS)]
          TablePathExpression [14-15] [a]
            PathExpression [14-15] [a]
              Identifier(a) [14-15] [a]
          Location [16-20] [JOIN]
          TablePathExpression [21-53] [b TABLESAMPLE...RVOIR (1 ROWS)]
            PathExpression [21-22] [b]
              Identifier(b) [21-22] [b]
            SampleClause [23-53] [TABLESAMPLE RESERVOIR (1 ROWS)]
              Identifier(RESERVOIR) [35-44] [RESERVOIR]
              SampleSize [46-52] [1 ROWS]
                IntLiteral(1) [46-47] [1]
--
SELECT
  *
FROM
  a
  JOIN
  b TABLESAMPLE RESERVOIR(1 ROWS)
==

select * from (a JOIN b) TABLESAMPLE RESERVOIR (1 ROWS)
--
QueryStatement [0-55] [select * from...RVOIR (1 ROWS)]
  Query [0-55] [select * from...RVOIR (1 ROWS)]
    Select [0-55] [select * from...RVOIR (1 ROWS)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-55] [from (a JOIN...ERVOIR (1 ROWS)]
        ParenthesizedJoin [14-55] [(a JOIN b)...ESERVOIR (1 ROWS)]
          Join [15-23] [a JOIN b]
            TablePathExpression [15-16] [a]
              PathExpression [15-16] [a]
                Identifier(a) [15-16] [a]
            Location [17-21] [JOIN]
            TablePathExpression [22-23] [b]
              PathExpression [22-23] [b]
                Identifier(b) [22-23] [b]
          SampleClause [25-55] [TABLESAMPLE RESERVOIR (1 ROWS)]
            Identifier(RESERVOIR) [37-46] [RESERVOIR]
            SampleSize [48-54] [1 ROWS]
              IntLiteral(1) [48-49] [1]
--
SELECT
  *
FROM
  (
    a
    JOIN
    b
  ) TABLESAMPLE RESERVOIR(1 ROWS)
==

SELECT * FROM Users TABLESAMPLE RESERVOIR (1 ROWS)
WITH WEIGHT {{|weight|AS weight}} {{|REPEATABLE(1)}}
--
ALTERNATION GROUP: <empty>
--
QueryStatement [0-62] [SELECT * FROM...WITH WEIGHT]
  Query [0-62] [SELECT * FROM...WITH WEIGHT]
    Select [0-62] [SELECT * FROM...WITH WEIGHT]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-62] [FROM Users...WITH WEIGHT]
        TablePathExpression [14-62] [Users TABLESAMPLE...ITH WEIGHT]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-62] [TABLESAMPLE...WITH WEIGHT]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-49] [1 ROWS]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [51-62] [WITH WEIGHT]
              WithWeight [51-62] [WITH WEIGHT]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT
--
ALTERNATION GROUP: REPEATABLE(1)
--
QueryStatement [0-77] [SELECT * FROM...REPEATABLE(1)]
  Query [0-77] [SELECT * FROM...REPEATABLE(1)]
    Select [0-77] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-77] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-77] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-77] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-49] [1 ROWS]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [51-77] [WITH WEIGHT  REPEATABLE(1)]
              WithWeight [51-77] [WITH WEIGHT  REPEATABLE(1)]
              RepeatableClause [64-77] [REPEATABLE(1)]
                IntLiteral(1) [75-76] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT REPEATABLE (1)
--
ALTERNATION GROUP: weight,
--
QueryStatement [0-69] [SELECT * FROM...WEIGHT weight]
  Query [0-69] [SELECT * FROM...WEIGHT weight]
    Select [0-69] [SELECT * FROM...WEIGHT weight]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-69] [FROM Users...WEIGHT weight]
        TablePathExpression [14-69] [Users TABLESAMPLE...GHT weight]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-69] [TABLESAMPLE...WEIGHT weight]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-49] [1 ROWS]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [51-69] [WITH WEIGHT weight]
              WithWeight [51-69] [WITH WEIGHT weight]
                Alias [63-69] [weight]
                  Identifier(weight) [63-69] [weight]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT AS weight
--
ALTERNATION GROUP: weight,REPEATABLE(1)
--
QueryStatement [0-83] [SELECT * FROM...REPEATABLE(1)]
  Query [0-83] [SELECT * FROM...REPEATABLE(1)]
    Select [0-83] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-83] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-83] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-83] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-49] [1 ROWS]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [51-83] [WITH WEIGHT...REPEATABLE(1)]
              WithWeight [51-83] [WITH WEIGHT...REPEATABLE(1)]
                Alias [63-69] [weight]
                  Identifier(weight) [63-69] [weight]
              RepeatableClause [70-83] [REPEATABLE(1)]
                IntLiteral(1) [81-82] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT AS weight REPEATABLE (1)
--
ALTERNATION GROUP: AS weight,
--
QueryStatement [0-72] [SELECT * FROM...AS weight]
  Query [0-72] [SELECT * FROM...AS weight]
    Select [0-72] [SELECT * FROM...AS weight]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-72] [FROM Users...AS weight]
        TablePathExpression [14-72] [Users TABLESAMPLE...AS weight]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-72] [TABLESAMPLE...AS weight]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-49] [1 ROWS]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [51-72] [WITH WEIGHT AS weight]
              WithWeight [51-72] [WITH WEIGHT AS weight]
                Alias [63-72] [AS weight]
                  Identifier(weight) [66-72] [weight]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT AS weight
--
ALTERNATION GROUP: AS weight,REPEATABLE(1)
--
QueryStatement [0-86] [SELECT * FROM...REPEATABLE(1)]
  Query [0-86] [SELECT * FROM...REPEATABLE(1)]
    Select [0-86] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-86] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-86] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-86] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [43-49] [1 ROWS]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [51-86] [WITH WEIGHT...REPEATABLE(1)]
              WithWeight [51-86] [WITH WEIGHT...REPEATABLE(1)]
                Alias [63-72] [AS weight]
                  Identifier(weight) [66-72] [weight]
              RepeatableClause [73-86] [REPEATABLE(1)]
                IntLiteral(1) [84-85] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT AS weight REPEATABLE (1)
==

SELECT * FROM Users TABLESAMPLE {{BERNOULLI|SYSTEM}} (1 PERCENT)
WITH WEIGHT {{|weight|AS weight}} {{|REPEATABLE(1)}}
--
ALTERNATION GROUP: BERNOULLI,,
--
QueryStatement [0-65] [SELECT * FROM...WITH WEIGHT]
  Query [0-65] [SELECT * FROM...WITH WEIGHT]
    Select [0-65] [SELECT * FROM...WITH WEIGHT]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-65] [FROM Users...WITH WEIGHT]
        TablePathExpression [14-65] [Users TABLESAMPLE...ITH WEIGHT]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-65] [TABLESAMPLE...WITH WEIGHT]
            Identifier(BERNOULLI) [32-41] [BERNOULLI]
            SampleSize [43-52] [1 PERCENT]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [54-65] [WITH WEIGHT]
              WithWeight [54-65] [WITH WEIGHT]
--
SELECT
  *
FROM
  Users TABLESAMPLE BERNOULLI(1 PERCENT) WITH WEIGHT
--
ALTERNATION GROUP: BERNOULLI,,REPEATABLE(1)
--
QueryStatement [0-80] [SELECT * FROM...REPEATABLE(1)]
  Query [0-80] [SELECT * FROM...REPEATABLE(1)]
    Select [0-80] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-80] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-80] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-80] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(BERNOULLI) [32-41] [BERNOULLI]
            SampleSize [43-52] [1 PERCENT]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [54-80] [WITH WEIGHT  REPEATABLE(1)]
              WithWeight [54-80] [WITH WEIGHT  REPEATABLE(1)]
              RepeatableClause [67-80] [REPEATABLE(1)]
                IntLiteral(1) [78-79] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE BERNOULLI(1 PERCENT) WITH WEIGHT REPEATABLE (1)
--
ALTERNATION GROUP: BERNOULLI,weight,
--
QueryStatement [0-72] [SELECT * FROM...WEIGHT weight]
  Query [0-72] [SELECT * FROM...WEIGHT weight]
    Select [0-72] [SELECT * FROM...WEIGHT weight]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-72] [FROM Users...WEIGHT weight]
        TablePathExpression [14-72] [Users TABLESAMPLE...GHT weight]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-72] [TABLESAMPLE...WEIGHT weight]
            Identifier(BERNOULLI) [32-41] [BERNOULLI]
            SampleSize [43-52] [1 PERCENT]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [54-72] [WITH WEIGHT weight]
              WithWeight [54-72] [WITH WEIGHT weight]
                Alias [66-72] [weight]
                  Identifier(weight) [66-72] [weight]
--
SELECT
  *
FROM
  Users TABLESAMPLE BERNOULLI(1 PERCENT) WITH WEIGHT AS weight
--
ALTERNATION GROUP: BERNOULLI,weight,REPEATABLE(1)
--
QueryStatement [0-86] [SELECT * FROM...REPEATABLE(1)]
  Query [0-86] [SELECT * FROM...REPEATABLE(1)]
    Select [0-86] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-86] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-86] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-86] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(BERNOULLI) [32-41] [BERNOULLI]
            SampleSize [43-52] [1 PERCENT]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [54-86] [WITH WEIGHT...REPEATABLE(1)]
              WithWeight [54-86] [WITH WEIGHT...REPEATABLE(1)]
                Alias [66-72] [weight]
                  Identifier(weight) [66-72] [weight]
              RepeatableClause [73-86] [REPEATABLE(1)]
                IntLiteral(1) [84-85] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE BERNOULLI(1 PERCENT) WITH WEIGHT AS weight REPEATABLE (1)
--
ALTERNATION GROUP: BERNOULLI,AS weight,
--
QueryStatement [0-75] [SELECT * FROM...AS weight]
  Query [0-75] [SELECT * FROM...AS weight]
    Select [0-75] [SELECT * FROM...AS weight]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-75] [FROM Users...AS weight]
        TablePathExpression [14-75] [Users TABLESAMPLE...AS weight]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-75] [TABLESAMPLE...AS weight]
            Identifier(BERNOULLI) [32-41] [BERNOULLI]
            SampleSize [43-52] [1 PERCENT]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [54-75] [WITH WEIGHT AS weight]
              WithWeight [54-75] [WITH WEIGHT AS weight]
                Alias [66-75] [AS weight]
                  Identifier(weight) [69-75] [weight]
--
SELECT
  *
FROM
  Users TABLESAMPLE BERNOULLI(1 PERCENT) WITH WEIGHT AS weight
--
ALTERNATION GROUP: BERNOULLI,AS weight,REPEATABLE(1)
--
QueryStatement [0-89] [SELECT * FROM...REPEATABLE(1)]
  Query [0-89] [SELECT * FROM...REPEATABLE(1)]
    Select [0-89] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-89] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-89] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-89] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(BERNOULLI) [32-41] [BERNOULLI]
            SampleSize [43-52] [1 PERCENT]
              IntLiteral(1) [43-44] [1]
            SampleSuffix [54-89] [WITH WEIGHT...REPEATABLE(1)]
              WithWeight [54-89] [WITH WEIGHT...REPEATABLE(1)]
                Alias [66-75] [AS weight]
                  Identifier(weight) [69-75] [weight]
              RepeatableClause [76-89] [REPEATABLE(1)]
                IntLiteral(1) [87-88] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE BERNOULLI(1 PERCENT) WITH WEIGHT AS weight REPEATABLE (1)
--
ALTERNATION GROUP: SYSTEM,,
--
QueryStatement [0-62] [SELECT * FROM...WITH WEIGHT]
  Query [0-62] [SELECT * FROM...WITH WEIGHT]
    Select [0-62] [SELECT * FROM...WITH WEIGHT]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-62] [FROM Users...WITH WEIGHT]
        TablePathExpression [14-62] [Users TABLESAMPLE...ITH WEIGHT]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-62] [TABLESAMPLE...WITH WEIGHT]
            Identifier(SYSTEM) [32-38] [SYSTEM]
            SampleSize [40-49] [1 PERCENT]
              IntLiteral(1) [40-41] [1]
            SampleSuffix [51-62] [WITH WEIGHT]
              WithWeight [51-62] [WITH WEIGHT]
--
SELECT
  *
FROM
  Users TABLESAMPLE SYSTEM(1 PERCENT) WITH WEIGHT
--
ALTERNATION GROUP: SYSTEM,,REPEATABLE(1)
--
QueryStatement [0-77] [SELECT * FROM...REPEATABLE(1)]
  Query [0-77] [SELECT * FROM...REPEATABLE(1)]
    Select [0-77] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-77] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-77] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-77] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(SYSTEM) [32-38] [SYSTEM]
            SampleSize [40-49] [1 PERCENT]
              IntLiteral(1) [40-41] [1]
            SampleSuffix [51-77] [WITH WEIGHT  REPEATABLE(1)]
              WithWeight [51-77] [WITH WEIGHT  REPEATABLE(1)]
              RepeatableClause [64-77] [REPEATABLE(1)]
                IntLiteral(1) [75-76] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE SYSTEM(1 PERCENT) WITH WEIGHT REPEATABLE (1)
--
ALTERNATION GROUP: SYSTEM,weight,
--
QueryStatement [0-69] [SELECT * FROM...WEIGHT weight]
  Query [0-69] [SELECT * FROM...WEIGHT weight]
    Select [0-69] [SELECT * FROM...WEIGHT weight]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-69] [FROM Users...WEIGHT weight]
        TablePathExpression [14-69] [Users TABLESAMPLE...GHT weight]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-69] [TABLESAMPLE...WEIGHT weight]
            Identifier(SYSTEM) [32-38] [SYSTEM]
            SampleSize [40-49] [1 PERCENT]
              IntLiteral(1) [40-41] [1]
            SampleSuffix [51-69] [WITH WEIGHT weight]
              WithWeight [51-69] [WITH WEIGHT weight]
                Alias [63-69] [weight]
                  Identifier(weight) [63-69] [weight]
--
SELECT
  *
FROM
  Users TABLESAMPLE SYSTEM(1 PERCENT) WITH WEIGHT AS weight
--
ALTERNATION GROUP: SYSTEM,weight,REPEATABLE(1)
--
QueryStatement [0-83] [SELECT * FROM...REPEATABLE(1)]
  Query [0-83] [SELECT * FROM...REPEATABLE(1)]
    Select [0-83] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-83] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-83] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-83] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(SYSTEM) [32-38] [SYSTEM]
            SampleSize [40-49] [1 PERCENT]
              IntLiteral(1) [40-41] [1]
            SampleSuffix [51-83] [WITH WEIGHT...REPEATABLE(1)]
              WithWeight [51-83] [WITH WEIGHT...REPEATABLE(1)]
                Alias [63-69] [weight]
                  Identifier(weight) [63-69] [weight]
              RepeatableClause [70-83] [REPEATABLE(1)]
                IntLiteral(1) [81-82] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE SYSTEM(1 PERCENT) WITH WEIGHT AS weight REPEATABLE (1)
--
ALTERNATION GROUP: SYSTEM,AS weight,
--
QueryStatement [0-72] [SELECT * FROM...AS weight]
  Query [0-72] [SELECT * FROM...AS weight]
    Select [0-72] [SELECT * FROM...AS weight]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-72] [FROM Users...AS weight]
        TablePathExpression [14-72] [Users TABLESAMPLE...AS weight]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-72] [TABLESAMPLE...AS weight]
            Identifier(SYSTEM) [32-38] [SYSTEM]
            SampleSize [40-49] [1 PERCENT]
              IntLiteral(1) [40-41] [1]
            SampleSuffix [51-72] [WITH WEIGHT AS weight]
              WithWeight [51-72] [WITH WEIGHT AS weight]
                Alias [63-72] [AS weight]
                  Identifier(weight) [66-72] [weight]
--
SELECT
  *
FROM
  Users TABLESAMPLE SYSTEM(1 PERCENT) WITH WEIGHT AS weight
--
ALTERNATION GROUP: SYSTEM,AS weight,REPEATABLE(1)
--
QueryStatement [0-86] [SELECT * FROM...REPEATABLE(1)]
  Query [0-86] [SELECT * FROM...REPEATABLE(1)]
    Select [0-86] [SELECT * FROM...REPEATABLE(1)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-86] [FROM Users...REPEATABLE(1)]
        TablePathExpression [14-86] [Users TABLESAMPLE...EATABLE(1)]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-86] [TABLESAMPLE...REPEATABLE(1)]
            Identifier(SYSTEM) [32-38] [SYSTEM]
            SampleSize [40-49] [1 PERCENT]
              IntLiteral(1) [40-41] [1]
            SampleSuffix [51-86] [WITH WEIGHT...REPEATABLE(1)]
              WithWeight [51-86] [WITH WEIGHT...REPEATABLE(1)]
                Alias [63-72] [AS weight]
                  Identifier(weight) [66-72] [weight]
              RepeatableClause [73-86] [REPEATABLE(1)]
                IntLiteral(1) [84-85] [1]
--
SELECT
  *
FROM
  Users TABLESAMPLE SYSTEM(1 PERCENT) WITH WEIGHT AS weight REPEATABLE (1)
==

# REPEATABLE is non-reserved keyword, hence, can be used as an alias for weight.
SELECT * FROM Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT REPEATABLE
--
QueryStatement [0-72] [SELECT * FROM...REPEATABLE]
  Query [0-72] [SELECT * FROM...REPEATABLE]
    Select [0-72] [SELECT * FROM...REPEATABLE]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-72] [FROM Users...REPEATABLE]
        TablePathExpression [14-72] [Users TABLESAMPLE...REPEATABLE]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
          SampleClause [20-72] [TABLESAMPLE...REPEATABLE]
            Identifier(RESERVOIR) [32-41] [RESERVOIR]
            SampleSize [42-48] [1 ROWS]
              IntLiteral(1) [42-43] [1]
            SampleSuffix [50-72] [WITH WEIGHT REPEATABLE]
              WithWeight [50-72] [WITH WEIGHT REPEATABLE]
                Alias [62-72] [REPEATABLE]
                  Identifier(REPEATABLE) [62-72] [REPEATABLE]
--
SELECT
  *
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS) WITH WEIGHT AS REPEATABLE
==

# WEIGHT is non-reserved keyword and can be used as an identifier.
SELECT 4 WEIGHT
from Users TABLESAMPLE RESERVOIR (1 ROWS)
--
QueryStatement [0-57] [SELECT 4 WEIGHT...OIR (1 ROWS)]
  Query [0-57] [SELECT 4 WEIGHT...OIR (1 ROWS)]
    Select [0-57] [SELECT 4 WEIGHT...OIR (1 ROWS)]
      SelectList [7-15] [4 WEIGHT]
        SelectColumn [7-15] [4 WEIGHT]
          IntLiteral(4) [7-8] [4]
          Alias [9-15] [WEIGHT]
            Identifier(WEIGHT) [9-15] [WEIGHT]
      FromClause [16-57] [from Users...ESERVOIR (1 ROWS)]
        TablePathExpression [21-57] [Users TABLESAMPLE...R (1 ROWS)]
          PathExpression [21-26] [Users]
            Identifier(Users) [21-26] [Users]
          SampleClause [27-57] [TABLESAMPLE RESERVOIR (1 ROWS)]
            Identifier(RESERVOIR) [39-48] [RESERVOIR]
            SampleSize [50-56] [1 ROWS]
              IntLiteral(1) [50-51] [1]
--
SELECT
  4 AS WEIGHT
FROM
  Users TABLESAMPLE RESERVOIR(1 ROWS)
==

# Query should fail while resolving. Sampling on arrays is not supported.
select * from UNNEST(array_expr) TABLESAMPLE RESERVOIR (1 ROWS)
--
QueryStatement [0-63] [select * from...RVOIR (1 ROWS)]
  Query [0-63] [select * from...RVOIR (1 ROWS)]
    Select [0-63] [select * from...RVOIR (1 ROWS)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-63] [from UNNEST...SERVOIR (1 ROWS)]
        TablePathExpression [14-63] [UNNEST(array_expr...R (1 ROWS)]
          UnnestExpression [14-32] [UNNEST(array_expr)]
            PathExpression [21-31] [array_expr]
              Identifier(array_expr) [21-31] [array_expr]
          SampleClause [33-63] [TABLESAMPLE RESERVOIR (1 ROWS)]
            Identifier(RESERVOIR) [45-54] [RESERVOIR]
            SampleSize [56-62] [1 ROWS]
              IntLiteral(1) [56-57] [1]
--
SELECT
  *
FROM
  UNNEST(array_expr) TABLESAMPLE RESERVOIR(1 ROWS)
==

select * from UNNEST(array_expr) WITH OFFSET pos TABLESAMPLE RESERVOIR (1 ROWS)
--
QueryStatement [0-79] [select * from...RVOIR (1 ROWS)]
  Query [0-79] [select * from...RVOIR (1 ROWS)]
    Select [0-79] [select * from...RVOIR (1 ROWS)]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-79] [from UNNEST...SERVOIR (1 ROWS)]
        TablePathExpression [14-79] [UNNEST(array_expr...R (1 ROWS)]
          UnnestExpression [14-32] [UNNEST(array_expr)]
            PathExpression [21-31] [array_expr]
              Identifier(array_expr) [21-31] [array_expr]
          WithOffset [33-48] [WITH OFFSET pos]
            Alias [45-48] [pos]
              Identifier(pos) [45-48] [pos]
          SampleClause [49-79] [TABLESAMPLE RESERVOIR (1 ROWS)]
            Identifier(RESERVOIR) [61-70] [RESERVOIR]
            SampleSize [72-78] [1 ROWS]
              IntLiteral(1) [72-73] [1]
--
SELECT
  *
FROM
  UNNEST(array_expr) WITH OFFSET AS pos TABLESAMPLE RESERVOIR(1 ROWS)
==

select * from T, T.a as arr TABLESAMPLE RESERVOIR (1 ROWS) WITH OFFSET pos
--
ERROR: Syntax error: Expected keyword WEIGHT but got keyword OFFSET [at 1:65]
select * from T, T.a as arr TABLESAMPLE RESERVOIR (1 ROWS) WITH OFFSET pos
                                                                ^
==

select * from ARRAY(select * from Users) TABLESAMPLE RESERVOIR (1 ROWS)
--
ERROR: Syntax error: Unexpected keyword ARRAY [at 1:15]
select * from ARRAY(select * from Users) TABLESAMPLE RESERVOIR (1 ROWS)
              ^
==

# TABLESAMPLE can only be applied to table subqueries.
select * from Users
where a IN((select * from a_s) TABLESAMPLE RESERVOIR (1 ROWS))
--
ERROR: Syntax error: Expected ")" but got keyword TABLESAMPLE [at 2:32]
where a IN((select * from a_s) TABLESAMPLE RESERVOIR (1 ROWS))
                               ^
==

select * from Users
where a IN (select * from a_s TABLESAMPLE RESERVOIR (1 ROWS))
--
QueryStatement [0-81] [select * from...(1 ROWS))]
  Query [0-81] [select * from...(1 ROWS))]
    Select [0-81] [select * from...(1 ROWS))]
      SelectList [7-8] [*]
        SelectColumn [7-8] [*]
          Star(*) [7-8] [*]
      FromClause [9-19] [from Users]
        TablePathExpression [14-19] [Users]
          PathExpression [14-19] [Users]
            Identifier(Users) [14-19] [Users]
      WhereClause [20-81] [where a IN...(1 ROWS))]
        InExpression(IN) [26-81] [a IN (select...(1 ROWS))]
          PathExpression [26-27] [a]
            Identifier(a) [26-27] [a]
          Location [28-30] [IN]
          Query [32-80] [select * from...RVOIR (1 ROWS)]
            Select [32-80] [select * from...RVOIR (1 ROWS)]
              SelectList [39-40] [*]
                SelectColumn [39-40] [*]
                  Star(*) [39-40] [*]
              FromClause [41-80] [from a_s TABLESAM...R (1 ROWS)]
                TablePathExpression [46-80] [a_s TABLESAMPLE...OIR (1 ROWS)]
                  PathExpression [46-49] [a_s]
                    Identifier(a_s) [46-49] [a_s]
                  SampleClause [50-80] [TABLESAMPLE RESERVOIR (1 ROWS)]
                    Identifier(RESERVOIR) [62-71] [RESERVOIR]
                    SampleSize [73-79] [1 ROWS]
                      IntLiteral(1) [73-74] [1]
--
SELECT
  *
FROM
  Users
WHERE
  a IN (
    SELECT
      *
    FROM
      a_s TABLESAMPLE RESERVOIR(1 ROWS)
  )
==

select uId
from ( a TABLESAMPLE RESERVOIR (1 ROWS) JOIN
       (select * from b) TABLESAMPLE RESERVOIR (1 ROWS) JOIN
       (c TABLESAMPLE RESERVOIR (1 PERCENT) JOIN
        d TABLESAMPLE RESERVOIR (1 ROWS)) TABLESAMPLE SYSTEM (1 ROWS)
     ) TABLESAMPLE RESERVOIR (5.0 PERCENT)
--
QueryStatement [0-278] [select uId...0 PERCENT)]
  Query [0-278] [select uId...0 PERCENT)]
    Select [0-278] [select uId...0 PERCENT)]
      SelectList [7-10] [uId]
        SelectColumn [7-10] [uId]
          PathExpression [7-10] [uId]
            Identifier(uId) [7-10] [uId]
      FromClause [11-278] [from ( a TABLESAM...0 PERCENT)]
        ParenthesizedJoin [16-278] [( a TABLESAMPLE...0 PERCENT)]
          Join [18-235] [a TABLESAMPLE...YSTEM (1 ROWS)]
            Join [18-111] [a TABLESAMPLE...RVOIR (1 ROWS)]
              TablePathExpression [18-50] [a TABLESAMPLE...RVOIR (1 ROWS)]
                PathExpression [18-19] [a]
                  Identifier(a) [18-19] [a]
                SampleClause [20-50] [TABLESAMPLE RESERVOIR (1 ROWS)]
                  Identifier(RESERVOIR) [32-41] [RESERVOIR]
                  SampleSize [43-49] [1 ROWS]
                    IntLiteral(1) [43-44] [1]
              Location [51-55] [JOIN]
              TableSubquery [63-111] [(select *...RESERVOIR (1 ROWS)]
                Query [64-79] [select * from b]
                  Select [64-79] [select * from b]
                    SelectList [71-72] [*]
                      SelectColumn [71-72] [*]
                        Star(*) [71-72] [*]
                    FromClause [73-79] [from b]
                      TablePathExpression [78-79] [b]
                        PathExpression [78-79] [b]
                          Identifier(b) [78-79] [b]
                SampleClause [81-111] [TABLESAMPLE RESERVOIR (1 ROWS)]
                  Identifier(RESERVOIR) [93-102] [RESERVOIR]
                  SampleSize [104-110] [1 ROWS]
                    IntLiteral(1) [104-105] [1]
            Location [112-116] [JOIN]
            ParenthesizedJoin [124-235] [(c TABLESAMPLE...STEM (1 ROWS)]
              Join [125-206] [c TABLESAMPLE...RVOIR (1 ROWS)]
                TablePathExpression [125-160] [c TABLESAMPLE...1 PERCENT)]
                  PathExpression [125-126] [c]
                    Identifier(c) [125-126] [c]
                  SampleClause [127-160] [TABLESAMPLE...1 PERCENT)]
                    Identifier(RESERVOIR) [139-148] [RESERVOIR]
                    SampleSize [150-159] [1 PERCENT]
                      IntLiteral(1) [150-151] [1]
                Location [161-165] [JOIN]
                TablePathExpression [174-206] [d TABLESAMPLE...RVOIR (1 ROWS)]
                  PathExpression [174-175] [d]
                    Identifier(d) [174-175] [d]
                  SampleClause [176-206] [TABLESAMPLE RESERVOIR (1 ROWS)]
                    Identifier(RESERVOIR) [188-197] [RESERVOIR]
                    SampleSize [199-205] [1 ROWS]
                      IntLiteral(1) [199-200] [1]
              SampleClause [208-235] [TABLESAMPLE SYSTEM (1 ROWS)]
                Identifier(SYSTEM) [220-226] [SYSTEM]
                SampleSize [228-234] [1 ROWS]
                  IntLiteral(1) [228-229] [1]
          SampleClause [243-278] [TABLESAMPLE...0 PERCENT)]
            Identifier(RESERVOIR) [255-264] [RESERVOIR]
            SampleSize [266-277] [5.0 PERCENT]
              FloatLiteral(5.0) [266-269] [5.0]
--
SELECT
  uId
FROM
  (
    a TABLESAMPLE RESERVOIR(1 ROWS)
    JOIN
    (
      SELECT
        *
      FROM
        b
    ) TABLESAMPLE RESERVOIR(1 ROWS)
    JOIN
    (
      c TABLESAMPLE RESERVOIR(1 PERCENT)
      JOIN
      d TABLESAMPLE RESERVOIR(1 ROWS)
    ) TABLESAMPLE SYSTEM(1 ROWS)
  ) TABLESAMPLE RESERVOIR(5.0 PERCENT)
==

select a from b WHERE true TABLESAMPLE SYSTEM (1 ROWS)
--
ERROR: Syntax error: Expected end of input but got keyword TABLESAMPLE [at 1:28]
select a from b WHERE true TABLESAMPLE SYSTEM (1 ROWS)
                           ^
==

select a from b LIMIT 5 TABLESAMPLE SYSTEM (1 ROWS)
--
ERROR: Syntax error: Expected end of input but got keyword TABLESAMPLE [at 1:25]
select a from b LIMIT 5 TABLESAMPLE SYSTEM (1 ROWS)
                        ^
==

select a from b ORDER BY a TABLESAMPLE SYSTEM (1 ROWS)
--
ERROR: Syntax error: Expected end of input but got keyword TABLESAMPLE [at 1:28]
select a from b ORDER BY a TABLESAMPLE SYSTEM (1 ROWS)
                           ^
==

select a FROM b TABLESAMPLE SYSTEM (1 ROWS) WHERE true ORDER BY a LIMIT 5
--
QueryStatement [0-73] [select a FROM...a LIMIT 5]
  Query [0-73] [select a FROM...a LIMIT 5]
    Select [0-54] [select a FROM...WHERE true]
      SelectList [7-8] [a]
        SelectColumn [7-8] [a]
          PathExpression [7-8] [a]
            Identifier(a) [7-8] [a]
      FromClause [9-43] [FROM b TABLESAMPL...M (1 ROWS)]
        TablePathExpression [14-43] [b TABLESAMPLE SYSTEM (1 ROWS)]
          PathExpression [14-15] [b]
            Identifier(b) [14-15] [b]
          SampleClause [16-43] [TABLESAMPLE SYSTEM (1 ROWS)]
            Identifier(SYSTEM) [28-34] [SYSTEM]
            SampleSize [36-42] [1 ROWS]
              IntLiteral(1) [36-37] [1]
      WhereClause [44-54] [WHERE true]
        BooleanLiteral(true) [50-54] [true]
    OrderBy [55-65] [ORDER BY a]
      OrderingExpression(ASC) [64-65] [a]
        PathExpression [64-65] [a]
          Identifier(a) [64-65] [a]
    LimitOffset [66-73] [LIMIT 5]
      IntLiteral(5) [72-73] [5]
--
SELECT
  a
FROM
  b TABLESAMPLE SYSTEM(1 ROWS)
WHERE
  true
ORDER BY a
LIMIT 5
==

select a from b TABLESAMPLE SYSTEM (NULL ROWS)
--
ERROR: Syntax error: Unexpected keyword NULL [at 1:37]
select a from b TABLESAMPLE SYSTEM (NULL ROWS)
                                    ^
==

select a from b TABLESAMPLE SYSTEM (1 ROWS) REPEATABLE(NULL)
--
ERROR: Syntax error: Unexpected keyword NULL [at 1:56]
select a from b TABLESAMPLE SYSTEM (1 ROWS) REPEATABLE(NULL)
                                                       ^
==

select * from KeyValue TABLESAMPLE RESERVOIR (100 ROWS PARTITION BY)
--
ERROR: Syntax error: Unexpected ")" [at 1:68]
select * from KeyValue TABLESAMPLE RESERVOIR (100 ROWS PARTITION BY)
                                                                   ^
