# Table with special values including null, min and max values.
[prepare_database]
[required_features=NUMERIC_TYPE]
CREATE TABLE AnalyticTableWithSpecialValues AS
SELECT CAST(1 AS INT64) as row_id,
       CAST(null AS numeric) as numeric_val UNION ALL
  SELECT 2, null UNION ALL
  SELECT 3, NUMERIC '-99999999999999999999999999999.999999999' UNION ALL
  SELECT 4, NUMERIC '-99999999999999999999999999999.999999999' UNION ALL
  SELECT 5, NUMERIC '-99999999999999999999999999998.999999999' UNION ALL
  SELECT 6, NUMERIC '-99999999999999999999999999994.999999999' UNION ALL
  SELECT 7,  10 UNION ALL
  SELECT 8,  11 UNION ALL
  SELECT 9,  11 UNION ALL
  SELECT 10, 12 UNION ALL
  SELECT 11, 13 UNION ALL
  SELECT 12, 13 UNION ALL
  SELECT 13, NUMERIC '99999999999999999999999999994.999999999' UNION ALL
  SELECT 14, NUMERIC '99999999999999999999999999998.999999999' UNION ALL
  SELECT 15, NUMERIC '99999999999999999999999999999.999999999' UNION ALL
  SELECT 16, NUMERIC '99999999999999999999999999999.999999999'
--
ARRAY<STRUCT<row_id INT64, numeric_val NUMERIC>>[
  {1, NULL},
  {2, NULL},
  {
    3,
    -99999999999999999999999999999.999999999
  },
  {
    4,
    -99999999999999999999999999999.999999999
  },
  {
    5,
    -99999999999999999999999999998.999999999
  },
  {
    6,
    -99999999999999999999999999994.999999999
  },
  {7, 10},
  {8, 11},
  {9, 11},
  {10, 12},
  {11, 13},
  {12, 13},
  {
    13,
    99999999999999999999999999994.999999999
  },
  {
    14,
    99999999999999999999999999998.999999999
  },
  {
    15,
    99999999999999999999999999999.999999999
  },
  {
    16,
    99999999999999999999999999999.999999999
  }
]
==

# Table without special values.
[prepare_database]
[required_features=NUMERIC_TYPE]
CREATE TABLE AnalyticTableWithoutSpecialValues AS
SELECT CAST(1 AS INT64) as row_id, CAST(10 AS numeric) as numeric_val UNION ALL
  SELECT 2, 11 UNION ALL
  SELECT 3, 11 UNION ALL
  SELECT 4, 12 UNION ALL
  SELECT 5, 13 UNION ALL
  SELECT 6, 13
--
ARRAY<STRUCT<row_id INT64, numeric_val NUMERIC>>[
  {1, 10},
  {2, 11},
  {3, 11},
  {4, 12},
  {5, 13},
  {6, 13}
]
==

[default required_features=ANALYTIC_FUNCTIONS,NUMERIC_TYPE]
[name=numeric_range_window_asc_with_special_values_1]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and 2 PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   1,
   2
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   1,
   2
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   1,
   2
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   1,
   5
 },
 {7, 10, 1, 6},
 {9, 11, 1, 6},
 {8, 11, 1, 6},
 {10, 12, 1, 7},
 {11, 13, 1, 9},
 {12, 13, 1, 9},
 {
   13,
   99999999999999999999999999994.999999999,
   1,
   12
 },
 {
   14,
   99999999999999999999999999998.999999999,
   1,
   13
 },
 {
   15,
   99999999999999999999999999999.999999999,
   1,
   13
 },
 {
   16,
   99999999999999999999999999999.999999999,
   1,
   13
 }]
==

[name=numeric_range_window_asc_with_special_values_underflow]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM (SELECT * FROM AnalyticTableWithSpecialValues WHERE numeric_val IS NOT NULL)
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and 2 PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{
   4,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   3,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   3,
   5
 },
 {7, 10, 3, 6},
 {9, 11, 3, 6},
 {8, 11, 3, 6},
 {10, 12, 3, 7},
 {12, 13, 3, 9},
 {11, 13, 3, 9},
 {
   13,
   99999999999999999999999999994.999999999,
   3,
   12
 },
 {
   14,
   99999999999999999999999999998.999999999,
   3,
   13
 },
 {
   16,
   99999999999999999999999999999.999999999,
   3,
   13
 },
 {
   15,
   99999999999999999999999999999.999999999,
   3,
   13
 }]
==

[name=numeric_range_window_asc_with_special_values_2]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and CURRENT ROW)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   1,
   4
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   1,
   4
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   1,
   5
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   1,
   6
 },
 {7, 10, 1, 7},
 {9, 11, 1, 9},
 {8, 11, 1, 9},
 {10, 12, 1, 10},
 {11, 13, 1, 12},
 {12, 13, 1, 12},
 {
   13,
   99999999999999999999999999994.999999999,
   1,
   13
 },
 {
   14,
   99999999999999999999999999998.999999999,
   1,
   14
 },
 {
   15,
   99999999999999999999999999999.999999999,
   1,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   1,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_3]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and 2 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   1,
   5
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   1,
   5
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   1,
   5
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   1,
   6
 },
 {7, 10, 1, 10},
 {9, 11, 1, 12},
 {8, 11, 1, 12},
 {10, 12, 1, 12},
 {11, 13, 1, 12},
 {12, 13, 1, 12},
 {
   13,
   99999999999999999999999999994.999999999,
   1,
   13
 },
 {
   14,
   99999999999999999999999999998.999999999,
   1,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   1,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   1,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_4]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 2 PRECEDING and 1 PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   3,
   4
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {7, 10, NULL, NULL},
 {9, 11, 7, 7},
 {8, 11, 7, 7},
 {10, 12, 7, 9},
 {11, 13, 8, 10},
 {12, 13, 8, 10},
 {
   13,
   99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   15,
   99999999999999999999999999999.999999999,
   14,
   14
 },
 {
   16,
   99999999999999999999999999999.999999999,
   14,
   14
 }]
==

[name=numeric_range_window_asc_with_special_values_5]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 1 PRECEDING and 2 PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {7, 10, NULL, NULL},
 {9, 11, NULL, NULL},
 {8, 11, NULL, NULL},
 {10, 12, NULL, NULL},
 {11, 13, NULL, NULL},
 {12, 13, NULL, NULL},
 {
   13,
   99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 }]
==

[name=numeric_range_window_asc_with_special_values_6]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 2 PRECEDING and CURRENT ROW)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   4
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   4
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   3,
   5
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   6
 },
 {7, 10, 7, 7},
 {9, 11, 7, 9},
 {8, 11, 7, 9},
 {10, 12, 7, 10},
 {11, 13, 8, 12},
 {12, 13, 8, 12},
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   13
 },
 {
   14,
   99999999999999999999999999998.999999999,
   14,
   14
 },
 {
   15,
   99999999999999999999999999999.999999999,
   14,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   14,
   16
 }]
==

[name=range_window_asc_with_special_values_7]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 2 PRECEDING and 2 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   5
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   5
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   3,
   5
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   6
 },
 {7, 10, 7, 10},
 {9, 11, 7, 12},
 {8, 11, 7, 12},
 {10, 12, 7, 12},
 {11, 13, 8, 12},
 {12, 13, 8, 12},
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   13
 },
 {
   14,
   99999999999999999999999999998.999999999,
   14,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   14,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   14,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_8]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 2 PRECEDING and UNBOUNDED FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 16},
 {2, NULL, 1, 16},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   16
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   16
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   3,
   16
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   16
 },
 {7, 10, 7, 16},
 {9, 11, 7, 16},
 {8, 11, 7, 16},
 {10, 12, 7, 16},
 {11, 13, 8, 16},
 {12, 13, 8, 16},
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   16
 },
 {
   14,
   99999999999999999999999999998.999999999,
   14,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   14,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   14,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_9]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN CURRENT ROW and CURRENT ROW)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   4
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   4
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   5,
   5
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   6
 },
 {7, 10, 7, 7},
 {9, 11, 8, 9},
 {8, 11, 8, 9},
 {10, 12, 10, 10},
 {11, 13, 11, 12},
 {12, 13, 11, 12},
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   13
 },
 {
   14,
   99999999999999999999999999998.999999999,
   14,
   14
 },
 {
   15,
   99999999999999999999999999999.999999999,
   15,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   15,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_10]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN CURRENT ROW and 2 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   5
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   5
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   5,
   5
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   6
 },
 {7, 10, 7, 10},
 {9, 11, 8, 12},
 {8, 11, 8, 12},
 {10, 12, 10, 12},
 {11, 13, 11, 12},
 {12, 13, 11, 12},
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   13
 },
 {
   14,
   99999999999999999999999999998.999999999,
   14,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   15,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   15,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_11]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN CURRENT ROW and UNBOUNDED FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 16},
 {2, NULL, 1, 16},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   16
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   16
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   5,
   16
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   16
 },
 {7, 10, 7, 16},
 {9, 11, 8, 16},
 {8, 11, 8, 16},
 {10, 12, 10, 16},
 {11, 13, 11, 16},
 {12, 13, 11, 16},
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   16
 },
 {
   14,
   99999999999999999999999999998.999999999,
   14,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   15,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   15,
   16
 }]
==

[name=numeric_range_window_asc_with_special_values_12]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 1 FOLLOWING and 2 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   5,
   5
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   5,
   5
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {7, 10, 8, 10},
 {9, 11, 10, 12},
 {8, 11, 10, 12},
 {10, 12, 11, 12},
 {11, 13, NULL, NULL},
 {12, 13, NULL, NULL},
 {
   13,
   99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   15,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 }]
==

[name=numeric_range_window_asc_with_special_values_13]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 2 FOLLOWING and 1 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {7, 10, NULL, NULL},
 {9, 11, NULL, NULL},
 {8, 11, NULL, NULL},
 {10, 12, NULL, NULL},
 {11, 13, NULL, NULL},
 {12, 13, NULL, NULL},
 {
   13,
   99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 }]
==

[name=numeric_range_window_asc_with_special_values_14]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 2 FOLLOWING and UNBOUNDED FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 16},
 {2, NULL, 1, 16},
 {
   3,
   -99999999999999999999999999999.999999999,
   6,
   16
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   6,
   16
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   6,
   16
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   7,
   16
 },
 {7, 10, 10, 16},
 {9, 11, 11, 16},
 {8, 11, 11, 16},
 {10, 12, 13, 16},
 {11, 13, 13, 16},
 {12, 13, 13, 16},
 {
   13,
   99999999999999999999999999994.999999999,
   14,
   16
 },
 {
   14,
   99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 }]
==

[name=numeric_range_window_asc_with_special_values_15]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN 1000 FOLLOWING and 2000 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {7, 10, NULL, NULL},
 {9, 11, NULL, NULL},
 {8, 11, NULL, NULL},
 {10, 12, NULL, NULL},
 {11, 13, NULL, NULL},
 {12, 13, NULL, NULL},
 {
   13,
   99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 }]
==

[name=numeric_range_window_asc_with_special_values_17]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN NUMERIC '99999999999999999999999999999.999999999' PRECEDING and
                           NUMERIC '99999999999999999999999999999.999999999' FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, NULL, 1, 2},
 {2, NULL, 1, 2},
 {
   3,
   -99999999999999999999999999999.999999999,
   3,
   6
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   3,
   6
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   3,
   6
 },
 {
   6,
   -99999999999999999999999999994.999999999,
   3,
   6
 },
 {7, 10, 7, 16},
 {9, 11, 7, 16},
 {8, 11, 7, 16},
 {10, 12, 7, 16},
 {11, 13, 7, 16},
 {12, 13, 7, 16},
 {
   13,
   99999999999999999999999999994.999999999,
   7,
   16
 },
 {
   14,
   99999999999999999999999999998.999999999,
   7,
   16
 },
 {
   15,
   99999999999999999999999999999.999999999,
   7,
   16
 },
 {
   16,
   99999999999999999999999999999.999999999,
   7,
   16
 }]
==

[name=numeric_range_window_desc_with_special_values_1]
SELECT row_id, numeric_val,
       MAX(row_id) OVER w start_boundary, MIN(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val DESC
             RANGE BETWEEN UNBOUNDED PRECEDING and 2 PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   13,
   99999999999999999999999999994.999999999,
   16,
   14
 },
 {11, 13, 16, 13},
 {12, 13, 16, 13},
 {10, 12, 16, 13},
 {9, 11, 16, 11},
 {8, 11, 16, 11},
 {7, 10, 16, 10},
 {
   6,
   -99999999999999999999999999994.999999999,
   16,
   7
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   16,
   6
 },
 {
   3,
   -99999999999999999999999999999.999999999,
   16,
   6
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   16,
   6
 },
 {1, NULL, 16, 1},
 {2, NULL, 16, 1}]
==

[name=numeric_range_window_desc_with_special_values_2]
SELECT row_id, numeric_val,
       MAX(row_id) OVER w start_boundary, MIN(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val DESC
             RANGE BETWEEN UNBOUNDED PRECEDING and CURRENT ROW)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{
   15,
   99999999999999999999999999999.999999999,
   16,
   15
 },
 {
   16,
   99999999999999999999999999999.999999999,
   16,
   15
 },
 {
   14,
   99999999999999999999999999998.999999999,
   16,
   14
 },
 {
   13,
   99999999999999999999999999994.999999999,
   16,
   13
 },
 {11, 13, 16, 11},
 {12, 13, 16, 11},
 {10, 12, 16, 10},
 {9, 11, 16, 8},
 {8, 11, 16, 8},
 {7, 10, 16, 7},
 {
   6,
   -99999999999999999999999999994.999999999,
   16,
   6
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   16,
   5
 },
 {
   3,
   -99999999999999999999999999999.999999999,
   16,
   3
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   16,
   3
 },
 {1, NULL, 16, 1},
 {2, NULL, 16, 1}]
==

[name=numeric_range_window_desc_with_special_values_3]
SELECT row_id, numeric_val,
       MAX(row_id) OVER w start_boundary, MIN(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val DESC
             RANGE BETWEEN UNBOUNDED PRECEDING and 2 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{
   15,
   99999999999999999999999999999.999999999,
   16,
   14
 },
 {
   16,
   99999999999999999999999999999.999999999,
   16,
   14
 },
 {
   14,
   99999999999999999999999999998.999999999,
   16,
   14
 },
 {
   13,
   99999999999999999999999999994.999999999,
   16,
   13
 },
 {11, 13, 16, 8},
 {12, 13, 16, 8},
 {10, 12, 16, 7},
 {9, 11, 16, 7},
 {8, 11, 16, 7},
 {7, 10, 16, 7},
 {
   6,
   -99999999999999999999999999994.999999999,
   16,
   6
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   16,
   3
 },
 {
   3,
   -99999999999999999999999999999.999999999,
   16,
   3
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   16,
   3
 },
 {1, NULL, 16, 1},
 {2, NULL, 16, 1}]
==

[name=numeric_range_window_desc_with_special_values_4]
SELECT row_id, numeric_val,
       MAX(row_id) OVER w start_boundary, MIN(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val DESC
             RANGE BETWEEN 2 PRECEDING and 1 PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{
   15,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   16,
   99999999999999999999999999999.999999999,
   NULL,
   NULL
 },
 {
   14,
   99999999999999999999999999998.999999999,
   16,
   15
 },
 {
   13,
   99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {11, 13, NULL, NULL},
 {12, 13, NULL, NULL},
 {10, 12, 12, 11},
 {9, 11, 12, 10},
 {8, 11, 12, 10},
 {7, 10, 10, 8},
 {
   6,
   -99999999999999999999999999994.999999999,
   NULL,
   NULL
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   NULL,
   NULL
 },
 {
   3,
   -99999999999999999999999999999.999999999,
   5,
   5
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   5,
   5
 },
 {1, NULL, 2, 1},
 {2, NULL, 2, 1}]
==

[name=numeric_range_window_desc_with_special_values_6]
SELECT row_id, numeric_val,
       MAX(row_id) OVER w start_boundary, MIN(row_id) OVER w end_boundary
FROM AnalyticTableWithSpecialValues
WINDOW w AS (ORDER BY numeric_val DESC
             RANGE BETWEEN 2 PRECEDING and CURRENT ROW)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{
   15,
   99999999999999999999999999999.999999999,
   16,
   15
 },
 {
   16,
   99999999999999999999999999999.999999999,
   16,
   15
 },
 {
   14,
   99999999999999999999999999998.999999999,
   16,
   14
 },
 {
   13,
   99999999999999999999999999994.999999999,
   13,
   13
 },
 {11, 13, 12, 11},
 {12, 13, 12, 11},
 {10, 12, 12, 10},
 {9, 11, 12, 8},
 {8, 11, 12, 8},
 {7, 10, 10, 7},
 {
   6,
   -99999999999999999999999999994.999999999,
   6,
   6
 },
 {
   5,
   -99999999999999999999999999998.999999999,
   5,
   5
 },
 {
   3,
   -99999999999999999999999999999.999999999,
   5,
   3
 },
 {
   4,
   -99999999999999999999999999999.999999999,
   5,
   3
 },
 {1, NULL, 2, 1},
 {2, NULL, 2, 1}]
==

[name=numeric_range_window_asc_without_special_values_1]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithoutSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and NUMERIC '2' PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, 10, NULL, NULL},
 {3, 11, NULL, NULL},
 {2, 11, NULL, NULL},
 {4, 12, 1, 1},
 {5, 13, 1, 3},
 {6, 13, 1, 3}]
==

[name=numeric_range_window_asc_without_special_values_2]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithoutSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and CURRENT ROW)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, 10, 1, 1},
 {3, 11, 1, 3},
 {2, 11, 1, 3},
 {4, 12, 1, 4},
 {5, 13, 1, 6},
 {6, 13, 1, 6}]
==

[name=numeric_range_window_asc_without_special_values_3]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithoutSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and 2 FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, 10, 1, 4},
 {3, 11, 1, 6},
 {2, 11, 1, 6},
 {4, 12, 1, 6},
 {5, 13, 1, 6},
 {6, 13, 1, 6}]
==

[name=numeric_range_window_asc_without_special_values_4]
SELECT row_id, numeric_val,
       MIN(row_id) OVER w start_boundary, MAX(row_id) OVER w end_boundary
FROM AnalyticTableWithoutSpecialValues
WINDOW w AS (ORDER BY numeric_val ASC
             RANGE BETWEEN UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{1, 10, 1, 6},
 {3, 11, 1, 6},
 {2, 11, 1, 6},
 {4, 12, 1, 6},
 {5, 13, 1, 6},
 {6, 13, 1, 6}]
==

[name=numeric_range_window_desc_without_special_values_1]
SELECT row_id, numeric_val,
       MAX(row_id) OVER w start_boundary, MIN(row_id) OVER w end_boundary
FROM AnalyticTableWithoutSpecialValues
WINDOW w AS (ORDER BY numeric_val DESC
             RANGE BETWEEN UNBOUNDED PRECEDING and NUMERIC '2' PRECEDING)
--
ARRAY<STRUCT<row_id INT64,
             numeric_val NUMERIC,
             start_boundary INT64,
             end_boundary INT64>>
[{5, 13, NULL, NULL},
 {6, 13, NULL, NULL},
 {4, 12, NULL, NULL},
 {3, 11, 6, 5},
 {2, 11, 6, 5},
 {1, 10, 6, 4}]
